(function(e){function t(t){for(var a,i,o=t[0],c=t[1],l=t[2],d=0,f=[];d<o.length;d++)i=o[d],s[i]&&f.push(s[i][0]),s[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},s={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var a=n("64a9"),s=n.n(a);s.a},"0767":function(e,t,n){"use strict";var a=n("b407"),s=n.n(a);s.a},2955:function(e,t,n){"use strict";var a=n("6baf"),s=n.n(a);s.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],i={name:"app",components:{}},o=i,c=(n("034f"),n("2877")),l=Object(c["a"])(o,s,r,!1,null,null,null);l.options.__file="App.vue";var u=l.exports,d=n("8c4f"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"background-app"}),n("div",{staticClass:"login-container"},[n("div",{staticClass:"login-app"},[e._m(0),n("div",{staticClass:"login-input-app"},[n("h2",[e._v("Se connecter")]),n("el-form",{attrs:{"label-position":"top","label-width":"100px",model:e.labels}},[n("el-form-item",{attrs:{label:"Email"}},[n("el-input",{attrs:{type:"email"},model:{value:e.labels.email,callback:function(t){e.$set(e.labels,"email",t)},expression:"labels.email"}})],1),n("el-form-item",{attrs:{label:"Mot de passe"}},[n("el-input",{attrs:{type:"password"},model:{value:e.labels.password,callback:function(t){e.$set(e.labels,"password",t)},expression:"labels.password"}})],1)],1),n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{disabled:e.loading,type:"primary"},on:{click:function(t){t.preventDefault(),e.submit_handler()}}},[e._v("\n          Let's go\n        ")])],1)])])])},p=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"brand"},[n("h1",[e._v("RentCars")])])}],v=n("bc3a"),m=n.n(v),h=n("2f62"),b=(n("f751"),n("d4ec")),g=n("bee2"),_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(b["a"])(this,e),Object.assign(this,{email:"",lastName:"",firstName:"",age:"",service:"",id:-1},t)}return Object(g["a"])(e,[{key:"isEmpty",get:function(){return""===this.email}}]),e}();a["default"].use(h["a"]);var C=new h["a"].Store({state:{user:new _},mutations:{login:function(e,t){e.user=new _(t)},logoff:function(e){e.user=null}},getters:{fullName:function(e){return"".concat(e.user.firstName," ").concat(e.user.lastName)}},actions:{}}),w={store:C,router:W,name:"Login",data:function(){return{labels:new _,loading:!1}},methods:{submit_handler:function(){this.loading=!0,this.setUser()},setUser:function(){var e=this;m.a.get("http://localhost:8080/RentalCarsUPEM/api/user?email=".concat(this.labels.email,"&password=").concat(this.labels.password)).then(function(t){console.log(t),e.loading=!1,C.commit("login",t.data),console.log(t.data),e.$router.push("home")}).catch(function(t){console.log(t),e.loading=!1,e.$notify.error({title:"Erreur",message:"Une erreur est survenue"})})}}},R=w,y=(n("2955"),Object(c["a"])(R,f,p,!1,null,"78763140",null));y.options.__file="Login.vue";var E=y.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Header"),n("router-view")],1)},k=[],$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"section"},[n("div",{staticClass:"container w-container"},[n("img",{staticClass:"image",attrs:{src:"https://uploads-ssl.webflow.com/5bf5afa9ba0bd51e495041ce/5bf97e3afad79debabd5da26_UPEM_LOGO.png",width:"120.5",alt:""}}),n("h4",[e._v("RaRoGui RMI")]),n("div",{staticClass:"user-info"},[n("img",{attrs:{src:"https://uploads-ssl.webflow.com/5bf5afa9ba0bd51e495041ce/5bf9828dc176118534ade2d5_5ad89256ffaa090558e0e9f2_head.svg",width:"42",alt:""}}),n("div",[n("div",[e._v(e._s(e.fullName))]),n("a",{staticClass:"logoff",on:{click:function(t){e.logoff_handler()}}},[e._v("Se déconnecter")])])])])]),n("div",{staticClass:"container w-container"},[n("el-menu",{attrs:{router:!0,"default-active":e.activeLink,mode:"horizontal"}},[n("el-menu-item",{attrs:{index:"/home"}},[e._v("Accueil")]),n("el-menu-item",{attrs:{index:"/home/rent"}},[e._v("Location")]),n("el-menu-item",{attrs:{index:"/home/requests"}},[e._v("Mes demandes")])],1)],1)])},x=[],O={store:C,router:W,name:"Header",data:function(){return{activeLink:null}},computed:{fullName:function(){return this.$store.getters.fullName}},methods:{logoff_handler:function(){this.$store.commit("logoff"),this.$router.push("login")}},mounted:function(){this.activeLink=this.$route.path},watch:{$route:function(e){this.activeLink=e.path}}},P=O,D=(n("94d7"),Object(c["a"])(P,$,x,!1,null,"fc96bd2e",null));D.options.__file="Header.vue";var j=D.exports,U={name:"home",components:{Header:j}},L=U,M=Object(c["a"])(L,q,k,!1,null,null,null);M.options.__file="Home.vue";var N=M.exports,I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"w-container"},[n("el-steps",{staticClass:"stepper",attrs:{active:e.step,"finish-status":"success"}},[n("el-step",{attrs:{title:"Date de location"}}),n("el-step",{attrs:{title:"Chosir son modèle"}}),n("el-step",{attrs:{title:"Vos réservations"}})],1),0===e.step?[n("el-button",{attrs:{disabled:null==e.date},on:{click:function(t){e.step+=1}}},[e._v("Suivant")]),n("div",{staticClass:"datepicker"},[n("span",[e._v("Choisissez votre période de location")]),n("el-date-picker",{attrs:{type:"daterange","start-placeholder":"Debut de la location","end-placeholder":"Fin de la location"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)]:e._e(),1===e.step?[n("div",[n("el-button",{on:{click:function(t){e.step-=1}}},[e._v("Précédent")]),n("el-button",{on:{click:function(t){e.step+=1}}},[e._v("Suivant")])],1),e._l(e.cars,function(t,a){return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:a,staticClass:"section-2"},[e._m(0,!0),n("div",{staticClass:"car-info"},[n("h3",{staticClass:"heading"},[e._v(e._s(t.brand)+" "+e._s(t.model))]),n("p",[e._v(e._s(t.nbDoors)+" portes")]),n("el-rate",{attrs:{value:Math.round(100*t.rate.toFixed(1))/100,disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value} / 5"},on:{input:function(e){t.rate=e.target.value}}}),n("div",{staticClass:"car-availability"},[t.rented?0===t.nbRequester?n("el-tag",{attrs:{type:"success"}},[e._v("\n            Soyez le premier à réserver ce modèle\n          ")]):1===t.nbRequester?n("el-tag",{attrs:{type:"info"}},[e._v("\n            Déjà "+e._s(t.nbRequester)+" personne en attente sur ce modèle\n          ")]):n("el-tag",{attrs:{type:"info"}},[e._v("\n            Déjà "+e._s(t.nbRequester)+" personnes en attente sur ce modèle\n          ")]):n("el-tag",{attrs:{type:"success"}},[e._v("Disponible")])],1)],1),n("div",{staticClass:"price"},[e._m(1,!0),n("div",{staticClass:"price-value"},[n("div",{staticClass:"div-block-4"},[n("div",[n("strong",[e._v(e._s(t.priceRent)+"€/jour TTC")])]),n("div",{staticClass:"text-block-2"},[e._v("soit "+e._s(e.totalPrice(t))+"€")])]),t.rented?n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.requestPending,expression:"car.requestPending"}],staticClass:"div-block-3",on:{click:function(n){e.rentHandler(t)}}},[e._v("\n            Réserver ce modèle\n          ")]):n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.requestPending,expression:"car.requestPending"}],staticClass:"div-block-3",on:{click:function(n){e.rentHandler(t)}}},[e._v("\n            Louer ce modèle\n          ")])])])])})]:e._e(),2===e.step?[n("el-button",{on:{click:function(t){e.step-=1}}},[e._v("Précédent")]),n("UserRequests")]:e._e()],2)},T=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{staticClass:"image-2",attrs:{src:"https://uploads-ssl.webflow.com/5bf5afa9ba0bd51e495041ce/5bf9871b4ae342456f82bae9_peugeot-208-5d-schwarz-2012.png",alt:""}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"price-name"},[n("h3",{staticClass:"heading-2"},[e._v("MEILLEUR PRIX - MODIFICATION & ANNULATION ")])])}],A=(n("20d6"),n("ac6a"),function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(b["a"])(this,e),Object.assign(this,{id:"",brand:"",model:"",state:0,nbDoors:0,rate:5,priceRent:0,nbRequester:0,rented:!1,requestPending:!1},t)}),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"w-container"},[e._l(e.carRequests,function(t,a){return n("div",{key:"car"+a,staticClass:"section-2"},[e._m(0,!0),n("div",{staticClass:"car-info"},[n("h3",{staticClass:"heading"},[e._v(e._s(t.car.brand)+" "+e._s(t.car.model))]),n("p",[e._v(e._s(t.car.nbDoors)+" portes")])]),n("div",{staticClass:"price"},[e._m(1,!0),n("div",{staticClass:"price-value"},["VALIDATED"===t.status?n("div",{staticClass:"div-block-3",on:{click:function(n){e.finishCar(t.car.id)}}},[e._v("\n          Retourner ce modèle\n        ")]):n("el-tag",{attrs:{type:"info"}},[e._v("En attente")])],1)])])}),0===e.carRequests.length?n("span",[e._v("Pas de voiture en location pour le moment")]):e._e(),n("el-button",{on:{click:function(t){e.getUserRequests()}}},[e._v("Actualiser")])],2)},H=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{staticClass:"image-2",attrs:{src:"https://uploads-ssl.webflow.com/5bf5afa9ba0bd51e495041ce/5bf9871b4ae342456f82bae9_peugeot-208-5d-schwarz-2012.png",alt:""}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"price-name"},[n("h3",{staticClass:"heading-2"},[e._v("ETAT DE VOTRE LOCATION")])])}],V={name:"UserRequests",data:function(){return{carRequests:[]}},methods:{getUserRequests:function(){var e=this;m.a.get("http://localhost:8080/RentalCarsUPEM/api/user-requests?userID=".concat(this.$store.state.user.id)).then(function(t){e.carRequests=t.data}).catch(function(t){e.$notify.error({title:"Erreur",message:t})})},finishCar:function(e){var t=this;m.a.get("http://localhost:8080/RentalCarsUPEM/api/end-rent?carID=".concat(e)).then(function(){t.getUserRequests()}).catch(function(e){t.$notify.error({title:"Erreur",message:e})})}},mounted:function(){this.getUserRequests()}},z=V,F=(n("d982"),Object(c["a"])(z,S,H,!1,null,"75dc979f",null));F.options.__file="UserRequests.vue";var B=F.exports,G={name:"Rent",components:{UserRequests:B},data:function(){return{cars:[],loading:!0,step:0,date:null}},computed:{nbDays:function(){if(null==this.date[0]||null==this.date[1])return 0;var e=new Date(this.date[0]),t=new Date(this.date[1]);return Math.abs((e-t)/864e5)}},methods:{totalPrice:function(e){return e.priceRent*this.nbDays},getCars:function(){var e=this;m.a.get("http://localhost:8080/RentalCarsUPEM/api/cars").then(function(t){var n=[];t.data.forEach(function(e){n.push(new A(e))}),e.cars=n,e.loading=!1}).catch(function(t){console.log(t),e.loading=!1,e.$notify.error({title:"Erreur",message:"Une erreur est survenue"})})},setCarRequestPending:function(e,t){var n=this.cars.findIndex(function(t){return t.id===e.id});n<0||(this.cars[n].requestPending=t)},rentHandler:function(e){var t=this;this.setCarRequestPending(e,!0),m.a.post("http://localhost:8080/RentalCarsUPEM/api/rent-car",{carID:e.id,userID:this.$store.state.user.id}).then(function(n){var a=n.data.rentStatus,s=n.data.rentQueuePosition;t.setCarRequestPending(e,!1),"VALIDATED"===a?t.$alert("Votre véhicule immatriculée: ".concat(e.id," vous attend !"),"Location ".concat(e.brand," ").concat(e.model),{confirmButtonText:"Mes réservations",callback:function(){t.$router.push("/home/requests")}}):t.$alert("Votre demande de location a bien été prise en compte ! Vous êtes à la ".concat(s,"ème position"),"Location ".concat(e.brand," ").concat(e.model),{confirmButtonText:"OK",callback:function(){}})}).catch(function(){t.setCarRequestPending(e,!1),t.$notify.error({title:"Erreur",message:"Une erreur est survenue"})})}},mounted:function(){setInterval(this.getCars(),2e3)}},J=G,K=(n("0767"),Object(c["a"])(J,I,T,!1,null,"d99c7382",null));K.options.__file="Rent.vue";var Q=K.exports;a["default"].use(d["a"]);var X=new d["a"]({routes:[{path:"*",component:E},{path:"/",component:E},{path:"/login",name:"login",component:E},{path:"/home",name:"home",component:N,meta:{requiresAuth:!0},children:[{path:"rent",name:"rent",component:Q},{path:"requests",name:"requests",component:B}]}]});X.beforeEach(function(e,t,n){var a=!C.state.user.isEmpty,s=e.matched.some(function(e){return e.meta.requiresAuth});s&&!a?n("login"):!s&&a?n("home"):n()});var W=X,Y=n("5c96"),Z=n.n(Y),ee=(n("0fae"),n("8f86")),te=n.n(ee);a["default"].use(Z.a,{locale:te.a}),a["default"].config.productionTip=!1,new a["default"]({router:W,store:C,render:function(e){return e(u)}}).$mount("#app")},"64a9":function(e,t,n){},"6baf":function(e,t,n){},"94d7":function(e,t,n){"use strict";var a=n("e98e"),s=n.n(a);s.a},af13:function(e,t,n){},b407:function(e,t,n){},d982:function(e,t,n){"use strict";var a=n("af13"),s=n.n(a);s.a},e98e:function(e,t,n){}});
//# sourceMappingURL=app.a3cf4f9c.js.map